(loop (body_expr (? <cond> (save <list1>) (save <list2>))) <init_val> <coll>)
(union (- <init_val> <coll>) (union (pi (select <coll> <cond>) <list1>) (pi (select <coll> (= <cond> 0)) <list2>)))
(loop (body_expr (? <cond> (add_all_fields <list>) <elseval>)) <init_val> <coll>)
(union (pi (select <coll> <cond>) <list>) <init_val>)
(loop (body_expr (save <repo> (tuple (join next <join_right>) <list>))) <init_val> <coll>)
(union (- <repo> (select <repo> (in id (pi (join <coll> <join_right>) id)))) (pi <list> (join <coll> <join_right>)))
(loop (body_expr (add_all_fields <receiver> (tuple (select <rel> (= <clm> (aref <col> <idx>))) <list>))) <init_val> <coll>)
(union (pi <list> (select <rel> (in <clm> <coll>))) <init_val>)
(loop (body_expr (+ <aggvar> (pi (select <rel> (= <clm> (aref <clmcond> <idx>))) <clmagg>))) <init_val> <coll>)
(+ (agg_sum (select <rel> (in <clm> <coll>)) <clmagg>) <init_val>)