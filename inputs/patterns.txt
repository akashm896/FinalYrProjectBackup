(loop (func_expr (? <cond> (save <list1>) (save <list2>))) <init_val> <coll>)
(union (pi (select <coll> <cond>) <list1>) (pi (select <coll> (= <cond> 0)) <list2>))
(loop (func_expr (? <cond> (add_all_fields <list>) <elseval>)) <init_val> <coll>)
(pi (select <coll> <cond>) <list>)
(loop (func_expr (save <repo> (tuple (join next <join_right>) <list>))) <init_val> <coll>)
(union <repo> (pi <list> (join <coll> <join_right>)))
(loop (func_expr (add_all_fields <receiver> (tuple (select <rel> (= <clm> (aref <col> <idx>))) <list>))) <init_val> <coll>)
(pi <list> (select <rel> (in <clm> <coll>)))
(loop (func_expr (+ <aggvar> (pi (select <rel> (= <clm> (aref <clmcond> <idx>))) <clmagg>))) <init_val> <coll>)
(agg_sum (select <rel> (in <clm> <coll>)) <clmagg>)